# Конфигурация SSH порта
---

Подробнее ознакомиться с протоколом ssh можно на [странице wiki.](https://ru.wikipedia.org/wiki/SSH)

### Изменение порта в приложении

##### Для версии gitflic 2.16.x и выше

**1.** После [установки](https://docs.gitflic.space/setup/gitflic_app/install) и [запуска](https://docs.gitflic.space/setup/gitflic_app/post_install) приложения, зайдите в панель администратора, в раздел **настройки**.</br>
**2.** Выберите **изменить ssh порт в remote url в проекте**</br>
**3.** Впишите порт, который указывали при [конфигурации](https://docs.gitflic.space/setup/gitflic_app/post_install) приложения в строке `ssh.server.port=` и нажмите сохранить.

<img src="https://gitflic.ru/project/gitflic/docs/blob/raw?file=img%2Fsetup%2Fchange_ssh.png" alt="Изменяемый параметр"> 
	
Ссылки генерируемые приложением автоматически примут необходимый вид. 

##### Для версии gitflic 2.15.x и ниже

***\*Рекомендуется освободить системный порт 22, так как в данных версиях нет возможности отображать корректно команду ssh запроса.***
	
Необходимо вручную модифицировать ssh запрос
```
git clone ssh://git@gitflic.ru:1234/adminuser/test.git
```
В данном запросе используются следующие параметры:

| Параметр | Описание |
| --- | --- |
| `ssh://git`|Указание протокола и git сервера. Должно обязательно присутствовать в запросе |
| `gitflic.ru` | Доменное имя вашего сервера|
| `1234` | Порт указанный в параметре `ssh.server.port=1234` в `application.properties`|
| `adminuser` | Учётная запись пользователя|
| `test.git` | Название проекта|


### Изменение системного порта ssh

\* Рекомендуется использовать официальные инструкции поставщика вашего ssh сервера. 
\* Ниже представлены обобщенные настройки для наиболее популярной службы **sshd**

#### Для Ubuntu и Debian-based дистрибутивов
	
**1.** Отредактируйте файл /etc/ssh/sshd_config
```
sudo nano /etc/ssh/sshd_config
```
```
sudo vi /etc/ssh/sshd_config
```
**2.** Раскомментируйте строку Port 22 и измените значение на любое не занятое системой *например 2222*.

**3.** Перезагрузите демон SSH
```
sudo systemctl restart ssh
```

##### Для Red OS

**1.** Отредактируйте файл /etc/ssh/sshd_config
```
sudo nano /etc/ssh/sshd_config
```
```
sudo vi /etc/ssh/sshd_config
```
**2.** Раскомментируйте строку Port 22 и измените значение на любое не занятое системой *например 2222*.
</br>
**3.** После того как был задан порт, необходимо предупредить систему безопасности операционной системы о внесённых изменениях. Если этого не сделать, то, при попытке перезапуска ssh-сервера, SELinux заблокирует его работу.

\* **#PORTNUMBER** - номер порта указанного в п.2
```
sudo semanage port -a -t ssh_port_t -p tcp #PORTNUMBER
```

**4.** Перезагрузите демон SSH
```
sudo systemctl restart ssh
```

